{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 7, "column": 0}, "map": {"version":3,"sources":["file:///home/user/studio/src/components/ui/card.tsx"],"sourcesContent":["/**\n * @fileoverview Componente de UI \"Card\" (Tarjeta).\n * Proporciona un contenedor estilizado para agrupar contenido relacionado,\n * con secciones para encabezado, contenido y pie de página.\n *\n * @see https://ui.shadcn.com/docs/components/card\n */\nimport * as React from \"react\"\n\nimport { cn } from \"@/lib/utils\"\n\n/**\n * Componente principal de la tarjeta, actúa como contenedor.\n */\nconst Card = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => (\n  <div\n    ref={ref}\n    className={cn(\n      \"rounded-lg border bg-card text-card-foreground shadow-sm\",\n      className\n    )}\n    {...props}\n  />\n))\nCard.displayName = \"Card\"\n\n/**\n * Sección de encabezado de la tarjeta.\n */\nconst CardHeader = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => (\n  <div\n    ref={ref}\n    className={cn(\"flex flex-col space-y-1.5 p-6\", className)}\n    {...props}\n  />\n))\nCardHeader.displayName = \"CardHeader\"\n\n/**\n * Componente para el título dentro de CardHeader.\n */\nconst CardTitle = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => (\n  <div\n    ref={ref}\n    className={cn(\n      \"text-2xl font-semibold leading-none tracking-tight\",\n      className\n    )}\n    {...props}\n  />\n))\nCardTitle.displayName = \"CardTitle\"\n\n/**\n * Componente para la descripción dentro de CardHeader.\n */\nconst CardDescription = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => (\n  <div\n    ref={ref}\n    className={cn(\"text-sm text-muted-foreground\", className)}\n    {...props}\n  />\n))\nCardDescription.displayName = \"CardDescription\"\n\n/**\n * Sección de contenido principal de la tarjeta.\n */\nconst CardContent = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => (\n  <div ref={ref} className={cn(\"p-6 pt-0\", className)} {...props} />\n))\nCardContent.displayName = \"CardContent\"\n\n/**\n * Sección de pie de página de la tarjeta.\n */\nconst CardFooter = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => (\n  <div\n    ref={ref}\n    className={cn(\"flex items-center p-6 pt-0\", className)}\n    {...props}\n  />\n))\nCardFooter.displayName = \"CardFooter\"\n\nexport { Card, CardHeader, CardFooter, CardTitle, CardDescription, CardContent }\n"],"names":[],"mappings":"AAAA;;;;;;CAMC;;;;;;;;;AACD;AAEA;;;;AAEA;;CAEC,GACD,MAAM,qBAAO,CAAA,GAAA,qMAAA,CAAA,aAAgB,AAAD,EAG1B,CAAC,EAAE,SAAS,EAAE,GAAG,OAAO,EAAE,oBAC1B,8OAAC;QACC,KAAK;QACL,WAAW,CAAA,GAAA,mHAAA,CAAA,KAAE,AAAD,EACV,4DACA;QAED,GAAG,KAAK;;;;;;AAGb,KAAK,WAAW,GAAG;AAEnB;;CAEC,GACD,MAAM,2BAAa,CAAA,GAAA,qMAAA,CAAA,aAAgB,AAAD,EAGhC,CAAC,EAAE,SAAS,EAAE,GAAG,OAAO,EAAE,oBAC1B,8OAAC;QACC,KAAK;QACL,WAAW,CAAA,GAAA,mHAAA,CAAA,KAAE,AAAD,EAAE,iCAAiC;QAC9C,GAAG,KAAK;;;;;;AAGb,WAAW,WAAW,GAAG;AAEzB;;CAEC,GACD,MAAM,0BAAY,CAAA,GAAA,qMAAA,CAAA,aAAgB,AAAD,EAG/B,CAAC,EAAE,SAAS,EAAE,GAAG,OAAO,EAAE,oBAC1B,8OAAC;QACC,KAAK;QACL,WAAW,CAAA,GAAA,mHAAA,CAAA,KAAE,AAAD,EACV,sDACA;QAED,GAAG,KAAK;;;;;;AAGb,UAAU,WAAW,GAAG;AAExB;;CAEC,GACD,MAAM,gCAAkB,CAAA,GAAA,qMAAA,CAAA,aAAgB,AAAD,EAGrC,CAAC,EAAE,SAAS,EAAE,GAAG,OAAO,EAAE,oBAC1B,8OAAC;QACC,KAAK;QACL,WAAW,CAAA,GAAA,mHAAA,CAAA,KAAE,AAAD,EAAE,iCAAiC;QAC9C,GAAG,KAAK;;;;;;AAGb,gBAAgB,WAAW,GAAG;AAE9B;;CAEC,GACD,MAAM,4BAAc,CAAA,GAAA,qMAAA,CAAA,aAAgB,AAAD,EAGjC,CAAC,EAAE,SAAS,EAAE,GAAG,OAAO,EAAE,oBAC1B,8OAAC;QAAI,KAAK;QAAK,WAAW,CAAA,GAAA,mHAAA,CAAA,KAAE,AAAD,EAAE,YAAY;QAAa,GAAG,KAAK;;;;;;AAEhE,YAAY,WAAW,GAAG;AAE1B;;CAEC,GACD,MAAM,2BAAa,CAAA,GAAA,qMAAA,CAAA,aAAgB,AAAD,EAGhC,CAAC,EAAE,SAAS,EAAE,GAAG,OAAO,EAAE,oBAC1B,8OAAC;QACC,KAAK;QACL,WAAW,CAAA,GAAA,mHAAA,CAAA,KAAE,AAAD,EAAE,8BAA8B;QAC3C,GAAG,KAAK;;;;;;AAGb,WAAW,WAAW,GAAG","debugId":null}},
    {"offset": {"line": 106, "column": 0}, "map": {"version":3,"sources":["file:///home/user/studio/src/components/ui/select.tsx"],"sourcesContent":["/**\n * @fileoverview Componente de UI \"Select\".\n * Muestra una lista de opciones para que el usuario elija una.\n *\n * @see https://ui.shadcn.com/docs/components/select\n */\n\"use client\"\n\nimport * as React from \"react\"\nimport * as SelectPrimitive from \"@radix-ui/react-select\"\nimport { Check, ChevronDown, ChevronUp } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\n/**\n * Componente raíz del selector.\n */\nconst Select = SelectPrimitive.Root\n\n/**\n * Agrupa opciones dentro del selector.\n */\nconst SelectGroup = SelectPrimitive.Group\n\n/**\n * Muestra el valor seleccionado.\n */\nconst SelectValue = SelectPrimitive.Value\n\n/**\n * El botón que abre/cierra el selector.\n */\nconst SelectTrigger = React.forwardRef<\n  React.ElementRef<typeof SelectPrimitive.Trigger>,\n  React.ComponentPropsWithoutRef<typeof SelectPrimitive.Trigger>\n>(({ className, children, ...props }, ref) => (\n  <SelectPrimitive.Trigger\n    ref={ref}\n    className={cn(\n      \"flex h-10 w-full items-center justify-between rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 [&>span]:line-clamp-1\",\n      className\n    )}\n    {...props}\n  >\n    {children}\n    <SelectPrimitive.Icon asChild>\n      <ChevronDown className=\"h-4 w-4 opacity-50\" />\n    </SelectPrimitive.Icon>\n  </SelectPrimitive.Trigger>\n))\nSelectTrigger.displayName = SelectPrimitive.Trigger.displayName\n\nconst SelectScrollUpButton = React.forwardRef<\n  React.ElementRef<typeof SelectPrimitive.ScrollUpButton>,\n  React.ComponentPropsWithoutRef<typeof SelectPrimitive.ScrollUpButton>\n>(({ className, ...props }, ref) => (\n  <SelectPrimitive.ScrollUpButton\n    ref={ref}\n    className={cn(\n      \"flex cursor-default items-center justify-center py-1\",\n      className\n    )}\n    {...props}\n  >\n    <ChevronUp className=\"h-4 w-4\" />\n  </SelectPrimitive.ScrollUpButton>\n))\nSelectScrollUpButton.displayName = SelectPrimitive.ScrollUpButton.displayName\n\nconst SelectScrollDownButton = React.forwardRef<\n  React.ElementRef<typeof SelectPrimitive.ScrollDownButton>,\n  React.ComponentPropsWithoutRef<typeof SelectPrimitive.ScrollDownButton>\n>(({ className, ...props }, ref) => (\n  <SelectPrimitive.ScrollDownButton\n    ref={ref}\n    className={cn(\n      \"flex cursor-default items-center justify-center py-1\",\n      className\n    )}\n    {...props}\n  >\n    <ChevronDown className=\"h-4 w-4\" />\n  </SelectPrimitive.ScrollDownButton>\n))\nSelectScrollDownButton.displayName =\n  SelectPrimitive.ScrollDownButton.displayName\n\n/**\n * Contenedor del contenido del selector (las opciones).\n */\nconst SelectContent = React.forwardRef<\n  React.ElementRef<typeof SelectPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof SelectPrimitive.Content>\n>(({ className, children, position = \"popper\", ...props }, ref) => (\n  <SelectPrimitive.Portal>\n    <SelectPrimitive.Content\n      ref={ref}\n      className={cn(\n        \"relative z-50 max-h-96 min-w-[8rem] overflow-hidden rounded-md border bg-popover text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2\",\n        position === \"popper\" &&\n          \"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1\",\n        className\n      )}\n      position={position}\n      {...props}\n    >\n      <SelectScrollUpButton />\n      <SelectPrimitive.Viewport\n        className={cn(\n          \"p-1\",\n          position === \"popper\" &&\n            \"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]\"\n        )}\n      >\n        {children}\n      </SelectPrimitive.Viewport>\n      <SelectScrollDownButton />\n    </SelectPrimitive.Content>\n  </SelectPrimitive.Portal>\n))\nSelectContent.displayName = SelectPrimitive.Content.displayName\n\n/**\n * Etiqueta para un grupo de opciones.\n */\nconst SelectLabel = React.forwardRef<\n  React.ElementRef<typeof SelectPrimitive.Label>,\n  React.ComponentPropsWithoutRef<typeof SelectPrimitive.Label>\n>(({ className, ...props }, ref) => (\n  <SelectPrimitive.Label\n    ref={ref}\n    className={cn(\"py-1.5 pl-8 pr-2 text-sm font-semibold\", className)}\n    {...props}\n  />\n))\nSelectLabel.displayName = SelectPrimitive.Label.displayName\n\n/**\n * Un elemento individual de opción en el selector.\n */\nconst SelectItem = React.forwardRef<\n  React.ElementRef<typeof SelectPrimitive.Item>,\n  React.ComponentPropsWithoutRef<typeof SelectPrimitive.Item>\n>(({ className, children, ...props }, ref) => (\n  <SelectPrimitive.Item\n    ref={ref}\n    className={cn(\n      \"relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50\",\n      className\n    )}\n    {...props}\n  >\n    <span className=\"absolute left-2 flex h-3.5 w-3.5 items-center justify-center\">\n      <SelectPrimitive.ItemIndicator>\n        <Check className=\"h-4 w-4\" />\n      </SelectPrimitive.ItemIndicator>\n    </span>\n\n    <SelectPrimitive.ItemText>{children}</SelectPrimitive.ItemText>\n  </SelectPrimitive.Item>\n))\nSelectItem.displayName = SelectPrimitive.Item.displayName\n\n/**\n * Separador visual entre grupos de opciones.\n */\nconst SelectSeparator = React.forwardRef<\n  React.ElementRef<typeof SelectPrimitive.Separator>,\n  React.ComponentPropsWithoutRef<typeof SelectPrimitive.Separator>\n>(({ className, ...props }, ref) => (\n  <SelectPrimitive.Separator\n    ref={ref}\n    className={cn(\"-mx-1 my-1 h-px bg-muted\", className)}\n    {...props}\n  />\n))\nSelectSeparator.displayName = SelectPrimitive.Separator.displayName\n\nexport {\n  Select,\n  SelectGroup,\n  SelectValue,\n  SelectTrigger,\n  SelectContent,\n  SelectLabel,\n  SelectItem,\n  SelectSeparator,\n  SelectScrollUpButton,\n  SelectScrollDownButton,\n}\n"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 319, "column": 0}, "map": {"version":3,"sources":["file:///home/user/studio/src/components/ui/popover.tsx"],"sourcesContent":["/**\n * @fileoverview Componente de UI \"Popover\".\n * Muestra contenido enriquecido en una ventana emergente que aparece\n * junto a un elemento disparador.\n *\n * @see https://ui.shadcn.com/docs/components/popover\n */\n\"use client\"\n\nimport * as React from \"react\"\nimport * as PopoverPrimitive from \"@radix-ui/react-popover\"\n\nimport { cn } from \"@/lib/utils\"\n\n/**\n * Componente raíz del popover.\n */\nconst Popover = PopoverPrimitive.Root\n\n/**\n * Elemento que activa la apertura del popover.\n */\nconst PopoverTrigger = PopoverPrimitive.Trigger\n\n/**\n * Contenedor del contenido del popover.\n */\nconst PopoverContent = React.forwardRef<\n  React.ElementRef<typeof PopoverPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof PopoverPrimitive.Content>\n>(({ className, align = \"center\", sideOffset = 4, ...props }, ref) => (\n  <PopoverPrimitive.Portal>\n    <PopoverPrimitive.Content\n      ref={ref}\n      align={align}\n      sideOffset={sideOffset}\n      className={cn(\n        \"z-50 w-72 rounded-md border bg-popover p-4 text-popover-foreground shadow-md outline-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2\",\n        className\n      )}\n      {...props}\n    />\n  </PopoverPrimitive.Portal>\n))\nPopoverContent.displayName = PopoverPrimitive.Content.displayName\n\nexport { Popover, PopoverTrigger, PopoverContent }\n"],"names":[],"mappings":"AAAA;;;;;;CAMC;;;;;;AAGD;AACA;AAEA;AALA;;;;;AAOA;;CAEC,GACD,MAAM,UAAU,mKAAA,CAAA,OAAqB;AAErC;;CAEC,GACD,MAAM,iBAAiB,mKAAA,CAAA,UAAwB;AAE/C;;CAEC,GACD,MAAM,+BAAiB,CAAA,GAAA,qMAAA,CAAA,aAAgB,AAAD,EAGpC,CAAC,EAAE,SAAS,EAAE,QAAQ,QAAQ,EAAE,aAAa,CAAC,EAAE,GAAG,OAAO,EAAE,oBAC5D,8OAAC,mKAAA,CAAA,SAAuB;kBACtB,cAAA,8OAAC,mKAAA,CAAA,UAAwB;YACvB,KAAK;YACL,OAAO;YACP,YAAY;YACZ,WAAW,CAAA,GAAA,mHAAA,CAAA,KAAE,AAAD,EACV,8aACA;YAED,GAAG,KAAK;;;;;;;;;;;AAIf,eAAe,WAAW,GAAG,mKAAA,CAAA,UAAwB,CAAC,WAAW","debugId":null}},
    {"offset": {"line": 372, "column": 0}, "map": {"version":3,"sources":["file:///home/user/studio/src/components/ui/calendar.tsx"],"sourcesContent":["/**\n * @fileoverview Componente de UI \"Calendar\" (Calendario).\n * Permite a los usuarios seleccionar fechas de un calendario interactivo.\n *\n * @see https://ui.shadcn.com/docs/components/calendar\n */\n\"use client\"\n\nimport * as React from \"react\"\nimport { ChevronLeft, ChevronRight } from \"lucide-react\"\nimport { DayPicker } from \"react-day-picker\"\n\nimport { cn } from \"@/lib/utils\"\nimport { buttonVariants } from \"@/components/ui/button\"\n\nexport type CalendarProps = React.ComponentProps<typeof DayPicker>\n\n/**\n * Componente de calendario para selección de fechas.\n * @param {CalendarProps} props - Propiedades del componente DayPicker.\n */\nfunction Calendar({\n  className,\n  classNames,\n  showOutsideDays = true,\n  ...props\n}: CalendarProps) {\n  return (\n    <DayPicker\n      showOutsideDays={showOutsideDays}\n      className={cn(\"p-3\", className)}\n      classNames={{\n        months: \"flex flex-col sm:flex-row space-y-4 sm:space-x-4 sm:space-y-0\",\n        month: \"space-y-4\",\n        caption: \"flex justify-center pt-1 relative items-center\",\n        caption_label: \"text-sm font-medium\",\n        nav: \"space-x-1 flex items-center\",\n        nav_button: cn(\n          buttonVariants({ variant: \"outline\" }),\n          \"h-7 w-7 bg-transparent p-0 opacity-50 hover:opacity-100\"\n        ),\n        nav_button_previous: \"absolute left-1\",\n        nav_button_next: \"absolute right-1\",\n        table: \"w-full border-collapse space-y-1\",\n        head_row: \"flex\",\n        head_cell:\n          \"text-muted-foreground rounded-md w-9 font-normal text-[0.8rem]\",\n        row: \"flex w-full mt-2\",\n        cell: \"h-9 w-9 text-center text-sm p-0 relative [&:has([aria-selected].day-range-end)]:rounded-r-md [&:has([aria-selected].day-outside)]:bg-accent/50 [&:has([aria-selected])]:bg-accent first:[&:has([aria-selected])]:rounded-l-md last:[&:has([aria-selected])]:rounded-r-md focus-within:relative focus-within:z-20\",\n        day: cn(\n          buttonVariants({ variant: \"ghost\" }),\n          \"h-9 w-9 p-0 font-normal aria-selected:opacity-100\"\n        ),\n        day_range_end: \"day-range-end\",\n        day_selected:\n          \"bg-primary text-primary-foreground hover:bg-primary hover:text-primary-foreground focus:bg-primary focus:text-primary-foreground\",\n        day_today: \"bg-accent text-accent-foreground\",\n        day_outside:\n          \"day-outside text-muted-foreground aria-selected:bg-accent/50 aria-selected:text-muted-foreground\",\n        day_disabled: \"text-muted-foreground opacity-50\",\n        day_range_middle:\n          \"aria-selected:bg-accent aria-selected:text-accent-foreground\",\n        day_hidden: \"invisible\",\n        ...classNames,\n      }}\n      components={{\n        IconLeft: ({ className, ...props }) => (\n          <ChevronLeft className={cn(\"h-4 w-4\", className)} {...props} />\n        ),\n        IconRight: ({ className, ...props }) => (\n          <ChevronRight className={cn(\"h-4 w-4\", className)} {...props} />\n        ),\n      }}\n      {...props}\n    />\n  )\n}\nCalendar.displayName = \"Calendar\"\n\nexport { Calendar }\n"],"names":[],"mappings":"AAAA;;;;;CAKC;;;;AAID;AAAA;AACA;AAEA;AACA;AAPA;;;;;;AAWA;;;CAGC,GACD,SAAS,SAAS,EAChB,SAAS,EACT,UAAU,EACV,kBAAkB,IAAI,EACtB,GAAG,OACW;IACd,qBACE,8OAAC,8JAAA,CAAA,YAAS;QACR,iBAAiB;QACjB,WAAW,CAAA,GAAA,mHAAA,CAAA,KAAE,AAAD,EAAE,OAAO;QACrB,YAAY;YACV,QAAQ;YACR,OAAO;YACP,SAAS;YACT,eAAe;YACf,KAAK;YACL,YAAY,CAAA,GAAA,mHAAA,CAAA,KAAE,AAAD,EACX,CAAA,GAAA,kIAAA,CAAA,iBAAc,AAAD,EAAE;gBAAE,SAAS;YAAU,IACpC;YAEF,qBAAqB;YACrB,iBAAiB;YACjB,OAAO;YACP,UAAU;YACV,WACE;YACF,KAAK;YACL,MAAM;YACN,KAAK,CAAA,GAAA,mHAAA,CAAA,KAAE,AAAD,EACJ,CAAA,GAAA,kIAAA,CAAA,iBAAc,AAAD,EAAE;gBAAE,SAAS;YAAQ,IAClC;YAEF,eAAe;YACf,cACE;YACF,WAAW;YACX,aACE;YACF,cAAc;YACd,kBACE;YACF,YAAY;YACZ,GAAG,UAAU;QACf;QACA,YAAY;YACV,UAAU,CAAC,EAAE,SAAS,EAAE,GAAG,OAAO,iBAChC,8OAAC,oNAAA,CAAA,cAAW;oBAAC,WAAW,CAAA,GAAA,mHAAA,CAAA,KAAE,AAAD,EAAE,WAAW;oBAAa,GAAG,KAAK;;;;;;YAE7D,WAAW,CAAC,EAAE,SAAS,EAAE,GAAG,OAAO,iBACjC,8OAAC,sNAAA,CAAA,eAAY;oBAAC,WAAW,CAAA,GAAA,mHAAA,CAAA,KAAE,AAAD,EAAE,WAAW;oBAAa,GAAG,KAAK;;;;;;QAEhE;QACC,GAAG,KAAK;;;;;;AAGf;AACA,SAAS,WAAW,GAAG","debugId":null}},
    {"offset": {"line": 460, "column": 0}, "map": {"version":3,"sources":["file:///home/user/studio/src/lib/data.ts"],"sourcesContent":["/**\n * @fileOverview Datos de prueba para la aplicación.\n * Este archivo contiene datos de ejemplo para campañas y contactos,\n * utilizados para poblar la interfaz de usuario hasta que se conecte una base de datos real.\n */\n\n/**\n * Datos de ejemplo para las campañas de correo electrónico.\n */\nexport const campaigns = [\n  {\n    name: \"Campaña de Bienvenida\",\n    status: \"TERMINADA\",\n    sent: \"5,000\",\n    opens: \"35%\",\n    clicks: \"8%\",\n    date: \"2024-07-01\",\n  },\n  {\n    name: \"Oferta Flash 24h\",\n    status: \"EXPIRADA\",\n    sent: \"2,500\",\n    opens: \"45%\",\n    clicks: \"15%\",\n    date: \"2024-07-10\",\n  },\n  {\n    name: \"Lanzamiento Nuevo Producto\",\n    status: \"INICIADA\",\n    sent: \"1,200\",\n    opens: \"12%\",\n    clicks: \"2%\",\n    date: \"2024-07-18\",\n  },\n  {\n    name: \"Promoción Black Friday\",\n    status: \"TIEMPO LIMITADO\",\n    sent: \"0\",\n    opens: \"-\",\n    clicks: \"-\",\n    date: \"2024-11-29\",\n  },\n  {\n    name: \"Venta de Aniversario\",\n    status: \"AGOTADA\",\n    sent: \"10,000\",\n    opens: \"50%\",\n    clicks: \"20%\",\n    date: \"2024-06-15\",\n  },\n];\n\n/**\n * Datos de ejemplo para las plantillas de correo.\n */\nexport const templates = [\n  {\n    id: \"1\",\n    name: \"Newsletter Mensual\",\n    description: \"Plantilla estándar para el boletín informativo de cada mes.\",\n    image: \"https://placehold.co/600x400.png\",\n    aiHint: \"abstract pattern\"\n  },\n  {\n    id: \"2\",\n    name: \"Anuncio de Producto\",\n    description: \"Plantilla para anunciar nuevos productos o características.\",\n    image: \"https://placehold.co/600x400.png\",\n    aiHint: \"product launch\"\n  },\n  {\n    id: \"3\",\n    name: \"Oferta Especial\",\n    description: \"Diseño llamativo para promociones y descuentos.\",\n    image: \"https://placehold.co/600x400.png\",\n    aiHint: \"special offer\"\n  },\n];\n\n\n/**\n * Datos de ejemplo para los contactos.\n */\nexport const contacts = [\n  {\n    email: \"juan.perez@example.com\",\n    name: \"Juan Perez\",\n    status: \"Suscrito\",\n    dateAdded: \"2024-07-10\",\n  },\n  {\n    email: \"maria.garcia@example.com\",\n    name: \"Maria Garcia\",\n    status: \"Suscrito\",\n    dateAdded: \"2024-07-09\",\n  },\n  {\n    email: \"baja@example.com\",\n    name: \"Carlos Baja\",\n    status: \"Baja\",\n    dateAdded: \"2024-06-20\",\n  },\n];\n\n/**\n * Datos de ejemplo para las encuestas.\n */\nexport const surveys = [\n  {\n    id: \"1\",\n    name: \"Feedback de Producto de TI\",\n    description: \"Encuesta para recopilar opiniones sobre nuestro último software.\",\n    responses: 150,\n  },\n  {\n    id: \"2\",\n    name: \"Satisfacción del Cliente Tech\",\n    description: \"Mide la satisfacción general de nuestros clientes con el soporte técnico.\",\n    responses: 278,\n  },\n  {\n    id: \"3\",\n    name: \"Interés en Nuevos Cursos\",\n    description: \"Sondeo sobre posibles nuevos cursos de desarrollo y TI.\",\n    responses: 45,\n  },\n];\n\n/**\n * Datos de ejemplo para los eventos.\n */\nexport const events = [\n  {\n    id: \"1\",\n    name: \"Taller de Marketing Digital\",\n    date: \"2024-08-15\",\n    status: \"Realizado\",\n    attendees: 75,\n  },\n  {\n    id: \"2\",\n    name: \"Conferencia de Liderazgo\",\n    date: \"2024-09-05\",\n    status: \"Próximo\",\n    attendees: 120,\n  },\n  {\n    id: \"3\",\n    name: \"Webinar de Nuevas Tecnologías\",\n    date: \"2024-07-20\",\n    status: \"Realizado\",\n    attendees: 250,\n  },\n];\n\n/**\n * Plantillas de certificados de ejemplo (mapeado por event.id).\n * El contenido es una imagen PNG codificada en base64.\n */\nexport const certificateTemplates = {\n  '1': 'iVBORw0KGgoAAAANSUhEUgAAAMgAAABkCAYAAADDlWIpAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAAAGSSURBVHhe7dJBDQAgDAAx2NB/yHwM46GE+zs7+8HBAgQIECAwERAgQIAAgYmAAAECEAEDAgECEQEBAgECEQEBAgECBAgQCAmY+wEECBAgQCAhIM4DBAgQIEAgISDOAwQIECBAICEgzoMECBAgQCAhIM4DBAgQIEAgISDOAwQIECBAICEgzoMECBAgQCAhIM4DBAgQIEAgISDOAwQIECBAICEgzoMECBAgQCAhIM4DBAgQIEAgISDOAwQIECBAICEgzoMECBAgQCAhIM4DBAgQIEAgISDOAwQIECBAICEgzoMECBAgQCAhIM4DBAgQIEAgISDOAwQIECBAICEgzoMECBAgQCAhIM4DBAgQIEAgISDOAwQIECBAICEgzoMECBAgQCAhIM4DBAgQIEAgISDOAwQIECBAICEgzoMECBAgQCAhIM4DBAgQIEAgISDOAwQIECBAICEgzoMECBAgQCAhIM4DBAgQIEAgISDOAwQIECBAICEgzoMECBAgQCAhIM4DBAgQIEAgISDOAwQIECBAICEgzoMECBAgQCAhIM4DBAgQIEAgISDOAwQIECBAICEgzoMECBAgQCAhIM4DBAgQIECAQEBAgAABAq8CgU5q3+UAAAAASUVORK5CYII=',\n};\n\n/**\n * Datos de ejemplo para los remitentes gestionados por TI.\n */\nexport const managedSenders = [\n  { name: 'Soporte Técnico', email: 'soporte@emailcraft.com' },\n  { name: 'Notificaciones del Sistema', email: 'noreply@emailcraft.com' },\n  { name: 'Comunicaciones Internas', email: 'comms@emailcraft.com' },\n];\n\n    "],"names":[],"mappings":"AAAA;;;;CAIC,GAED;;CAEC;;;;;;;;;AACM,MAAM,YAAY;IACvB;QACE,MAAM;QACN,QAAQ;QACR,MAAM;QACN,OAAO;QACP,QAAQ;QACR,MAAM;IACR;IACA;QACE,MAAM;QACN,QAAQ;QACR,MAAM;QACN,OAAO;QACP,QAAQ;QACR,MAAM;IACR;IACA;QACE,MAAM;QACN,QAAQ;QACR,MAAM;QACN,OAAO;QACP,QAAQ;QACR,MAAM;IACR;IACA;QACE,MAAM;QACN,QAAQ;QACR,MAAM;QACN,OAAO;QACP,QAAQ;QACR,MAAM;IACR;IACA;QACE,MAAM;QACN,QAAQ;QACR,MAAM;QACN,OAAO;QACP,QAAQ;QACR,MAAM;IACR;CACD;AAKM,MAAM,YAAY;IACvB;QACE,IAAI;QACJ,MAAM;QACN,aAAa;QACb,OAAO;QACP,QAAQ;IACV;IACA;QACE,IAAI;QACJ,MAAM;QACN,aAAa;QACb,OAAO;QACP,QAAQ;IACV;IACA;QACE,IAAI;QACJ,MAAM;QACN,aAAa;QACb,OAAO;QACP,QAAQ;IACV;CACD;AAMM,MAAM,WAAW;IACtB;QACE,OAAO;QACP,MAAM;QACN,QAAQ;QACR,WAAW;IACb;IACA;QACE,OAAO;QACP,MAAM;QACN,QAAQ;QACR,WAAW;IACb;IACA;QACE,OAAO;QACP,MAAM;QACN,QAAQ;QACR,WAAW;IACb;CACD;AAKM,MAAM,UAAU;IACrB;QACE,IAAI;QACJ,MAAM;QACN,aAAa;QACb,WAAW;IACb;IACA;QACE,IAAI;QACJ,MAAM;QACN,aAAa;QACb,WAAW;IACb;IACA;QACE,IAAI;QACJ,MAAM;QACN,aAAa;QACb,WAAW;IACb;CACD;AAKM,MAAM,SAAS;IACpB;QACE,IAAI;QACJ,MAAM;QACN,MAAM;QACN,QAAQ;QACR,WAAW;IACb;IACA;QACE,IAAI;QACJ,MAAM;QACN,MAAM;QACN,QAAQ;QACR,WAAW;IACb;IACA;QACE,IAAI;QACJ,MAAM;QACN,MAAM;QACN,QAAQ;QACR,WAAW;IACb;CACD;AAMM,MAAM,uBAAuB;IAClC,KAAK;AACP;AAKO,MAAM,iBAAiB;IAC5B;QAAE,MAAM;QAAmB,OAAO;IAAyB;IAC3D;QAAE,MAAM;QAA8B,OAAO;IAAyB;IACtE;QAAE,MAAM;QAA2B,OAAO;IAAuB;CAClE","debugId":null}},
    {"offset": {"line": 626, "column": 0}, "map": {"version":3,"sources":["file:///home/user/studio/src/app/actions/send-campaign-action.ts"],"sourcesContent":["\n'use server';\n\nimport 'isomorphic-fetch';\nimport { ClientSecretCredential } from '@azure/identity';\nimport { Client } from '@microsoft/microsoft-graph-client';\nimport { TokenCredentialAuthenticationProvider } from '@microsoft/microsoft-graph-client/authProviders/azureTokenCredentials';\nimport mysql from 'mysql2/promise';\n// Importa la función parse del paquete csv-parse/sync para parsear archivos CSV de forma síncrona.\nimport { parse } from 'csv-parse/sync';\n// Importa todas las funciones del paquete xlsx bajo el alias XLSX para trabajar con archivos Excel.\nimport * as XLSX from 'xlsx';\n// Importa la constante 'events' desde el módulo de datos local.\nimport { events } from '@/lib/data';\nimport { hasPermission, APP_PERMISSIONS, type Role } from '@/lib/permissions';\n\n/**\n * @fileoverview Acción de servidor para enviar una campaña de correo electrónico.\n * Obtiene destinatarios desde una fuente de datos y los envía por lotes\n * para respetar los límites de la API, utilizando Microsoft Graph.\n *\n * Las acciones de servidor se ejecutan en el lado del servidor y pueden ser llamadas\n * desde el lado del cliente.\n */\n\n// Define una interfaz para el payload que se espera al enviar una campaña.\ninterface SendCampaignPayload {\n  subject: string; // El asunto del correo electrónico.\n  // El cuerpo del correo electrónico en formato HTML.\n  htmlBody: string;\n  recipientData: {\n    type: 'date' | 'csv' | 'sql' | 'excel';\n    value: string;\n  };\n  senderEmail: string;\n  // Propiedad opcional para adjuntar un archivo al correo.\n  attachment?: {\n    filename: string; // El nombre del archivo adjunto.\n    contentType: string; // El tipo MIME del archivo adjunto.\n    // El contenido del archivo adjunto codificado en base64.\n    content: string; // base64 content\n  };\n  // ID opcional de un evento para personalizar el correo (ej: fecha del evento).\n  eventId?: string; // ID opcional de un evento.\n  role: Role; // Rol del usuario que ejecuta la acción para verificación de permisos\n}\n\ninterface Recipient {\n  email: string;\n  name?: string;\n}\n\n/**\n * Obtiene una lista de destinatarios desde la fuente especificada.\n */\nasync function getRecipients(\n  recipientData: SendCampaignPayload['recipientData']\n): Promise<Recipient[]> {\n  const { type, value } = recipientData;\n  // Desestructura el tipo y el valor de los datos del destinatario.\n\n  // Función auxiliar para encontrar una clave en un objeto de forma insensible a mayúsculas/minúsculas.\n  const findKey = (obj: object, potentialKeys: string[]) => {\n    // Itera sobre las claves del objeto.\n    const key = Object.keys(obj).find(k => potentialKeys.includes(k.toLowerCase()));\n    // Si encuentra una clave que coincide (insensible a mayúsculas/minúsculas), devuelve su valor; de lo contrario, undefined.\n    return key ? obj[key as keyof typeof obj] : undefined;\n  };\n\n  if (type === 'csv') {\n    try {\n      const records = parse(value, {\n        columns: true,\n        // Especifica que la primera fila contiene nombres de columnas.\n        skip_empty_lines: true,\n        // Omite las líneas vacías del archivo CSV.\n      });\n      // Parsear el valor del CSV en un array de objetos.\n      if (records.length === 0) return [];\n      // Si no hay registros, retorna un array vacío.\n\n      const emailKey = Object.keys(records[0]).find(k => k.toLowerCase() === 'email');\n      // Busca la clave 'email' (insensible a mayúsculas/minúsculas) en el primer registro.\n      if (!emailKey) throw new Error('La columna \"email\" no se encontró en el archivo CSV.');\n      // Si no se encuentra la columna 'email', lanza un error.\n\n      return records.map((record: any) => ({\n        email: record[emailKey],\n        name: findKey(record, ['name', 'nombre', 'fullname', 'nombre completo']),\n      })).filter((r: Recipient) => r.email && r.email.includes('@'));\n      // Mapea los registros para crear objetos Recipient y filtra los que no tienen un email válido.\n    } catch (error) {\n      console.error('Error al procesar el archivo CSV:', error);\n      throw new Error(`Error al procesar el archivo CSV: ${(error as Error).message}`);\n    }\n  }\n\n  if (type === 'excel') {\n    try {\n      // Decodifica el contenido base64 del archivo Excel a un buffer.\n      const buffer = Buffer.from(value, 'base64');\n      // Lee el buffer como un libro de trabajo de Excel.\n      const workbook = XLSX.read(buffer, { type: 'buffer' });\n      // Obtiene el nombre de la primera hoja del libro de trabajo.\n      const sheetName = workbook.SheetNames[0];\n      // Obtiene la hoja de trabajo por su nombre.\n      const worksheet = workbook.Sheets[sheetName];\n      // Convierte la hoja de trabajo a un array de objetos JSON.\n      const jsonData: any[] = XLSX.utils.sheet_to_json(worksheet);\n      if (jsonData.length === 0) return [];\n      // Si no hay datos JSON, retorna un array vacío.\n\n      const emailKey = Object.keys(jsonData[0]).find(key => key.toLowerCase() === 'email');\n      // Busca la clave 'email' (insensible a mayúsculas/minúsculas) en el primer objeto JSON.\n      if (!emailKey) throw new Error('La columna \"email\" no se encontró en el archivo Excel.');\n      // Si no se encuentra la columna 'email', lanza un error.\n\n      return jsonData.map(row => ({\n        email: row[emailKey],\n        name: findKey(row, ['name', 'nombre', 'fullname', 'nombre completo']),\n      })).filter(r => r.email && typeof r.email === 'string' && r.email.includes('@'));\n    } catch (error) {\n      console.error('Error al procesar el archivo Excel:', error);\n      throw new Error(`Error al procesar el archivo Excel: ${(error as Error).message}`);\n    }\n  }\n\n  const { MYSQL_HOST, MYSQL_USER, MYSQL_PASSWORD, MYSQL_DATABASE, MYSQL_PORT } = process.env;\n  // Desestructura las variables de entorno para la conexión a la base de datos.\n  if (!MYSQL_HOST || !MYSQL_USER || !MYSQL_DATABASE) {\n    throw new Error('Faltan las variables de entorno de la base de datos. Por favor, configúralas.');\n  }\n  // Verifica que las variables de entorno necesarias para la base de datos estén configuradas. Si faltan, lanza un error.\n\n\n  let connection;\n  try {\n    connection = await mysql.createConnection({\n      host: MYSQL_HOST,\n      port: MYSQL_PORT ? parseInt(MYSQL_PORT, 10) : 3306,\n      user: MYSQL_USER,\n      // Convierte el puerto a número si está definido, de lo contrario usa 3306.\n      password: MYSQL_PASSWORD,\n      database: MYSQL_DATABASE,\n    });\n    // Crea una conexión a la base de datos MySQL utilizando las variables de entorno.\n\n    let sql_query = '';\n    let params: any[] = [];\n    // Inicializa la variable para la consulta SQL y los parámetros.\n\n    // Si el tipo de datos del destinatario es 'date', construye la consulta SQL para obtener contactos por fecha.\n    if (type === 'date') {\n      sql_query = `\n        SELECT t1.email, t1.nombre_completo as name\n        FROM order_data AS t1 INNER JOIN order_data_online AS t2 ON t1.Ds_Merchant_Order = t2.Ds_Order\n        WHERE\n            t1.fecha_visita = ?\n            AND t2.Ds_ErrorCode = '00'\n            AND t2.Ds_ErrorMessage = 'completed'\n            AND NOT t1.email IN ('alberto.silva@papalote.org.mx', 'alejandracervantesm@gmail.com')\n      `;\n      params = [value];\n      // El valor se usa como parámetro para la fecha de visita.\n      // Si el tipo de datos del destinatario es 'sql', usa el valor directamente como consulta SQL.\n    } else if (type === 'sql') {\n      sql_query = value;\n      params = []; // Las consultas SQL personalizadas no esperan parámetros por defecto aquí.\n    }\n\n    const [rows] = await connection.execute(sql_query, params);\n    return (rows as Recipient[]).filter(row => row.email);\n    // Ejecuta la consulta SQL y filtra las filas para asegurarse de que tengan un email.\n  } catch (error) {\n    console.error('Error al conectar o consultar la base de datos:', error);\n    throw new Error('No se pudo obtener los contactos de la base de datos.');\n    // Captura y loguea errores de conexión o consulta de la base de datos, luego lanza un nuevo error.\n  } finally {\n    if (connection) await connection.end();\n    // Asegura que la conexión a la base de datos se cierre al finalizar (éxito o error).\n  }\n}\n\n// Función asíncrona para obtener una instancia del cliente de Microsoft Graph.\nasync function getGraphClient() {\n    // Desestructura las variables de entorno necesarias para la autenticación con Microsoft Graph.\n    const { GRAPH_CLIENT_ID, GRAPH_TENANT_ID, GRAPH_CLIENT_SECRET } = process.env;\n    if (!GRAPH_CLIENT_ID || !GRAPH_TENANT_ID || !GRAPH_CLIENT_SECRET) {\n        throw new Error('Faltan las variables de entorno de Microsoft Graph. Por favor, configúralas.');\n    }\n    const credential = new ClientSecretCredential(GRAPH_TENANT_ID, GRAPH_CLIENT_ID, GRAPH_CLIENT_SECRET);\n    const authProvider = new TokenCredentialAuthenticationProvider(credential, { scopes: ['https://graph.microsoft.com/.default'] });\n    return Client.initWithMiddleware({ authProvider });\n}\n\n// Función de utilidad para crear un retraso basado en un número de milisegundos.\nconst delay = (ms: number) => new Promise(res => setTimeout(res, ms));\n\n\n/**\n * Envía un correo electrónico utilizando Microsoft Graph con una política de reintentos.\n * @param graphClient - El cliente de Microsoft Graph.\n * @param message - El objeto de mensaje a enviar.\n * @param userMail - El correo del usuario remitente.\n * @param maxRetries - El número máximo de reintentos.\n * @throws Si el envío falla después de todos los reintentos.\n */\nasync function sendEmailWithRetry(graphClient: Client, message: any, userMail: string, maxRetries = 3) {\n    for (let i = 0; i < maxRetries; i++) {\n        try {\n            await graphClient.api(`/users/${userMail}/sendMail`).post({ message, saveToSentItems: 'true' });\n            return; // Éxito\n        } catch (error: any) {\n            // Verifica si es un error de throttling (demasiadas solicitudes)\n            if (error.statusCode === 429 && i < maxRetries - 1) {\n                // Obtiene el tiempo de espera del encabezado 'retry-after' o usa un backoff exponencial.\n                const retryAfter = error.responseHeaders?.['retry-after'] || Math.pow(2, i);\n                console.warn(`Throttled por la API de Graph. Reintentando en ${retryAfter} segundos...`);\n                await delay(retryAfter * 1000);\n            } else {\n                // Si es otro tipo de error, lo relanza para que sea manejado más arriba.\n                throw error;\n            }\n        }\n    }\n    // Si todos los reintentos fallan, lanza un error.\n    throw new Error(`No se pudo enviar el correo después de ${maxRetries} reintentos.`);\n}\n\n\n// Acción de servidor principal para enviar la campaña de correo electrónico.\nexport async function sendCampaign(payload: SendCampaignPayload) {\n  const { subject, htmlBody, recipientData, attachment, eventId, role, senderEmail } = payload;\n  \n  if (!hasPermission(role, APP_PERMISSIONS.SEND_CAMPAIGN)) {\n    throw new Error('Acceso denegado: No tienes permiso para enviar campañas.');\n  }\n  \n  // Estos ajustes ahora están configurados globalmente (ej: en la página de Ajustes).\n  // Para esta acción, usaremos valores por defecto. En una aplicación real, se obtendrían de una base de datos o servicio de configuración.\n  const batchSize = 50;\n  const emailDelay = 100; // milisegundos\n  const batchDelay = 5; // segundos\n\n  const startTime = Date.now();\n  // Registra el tiempo de inicio para calcular la duración total.\n\n  if (!senderEmail) {\n    throw new Error('Falta el correo del remitente. Por favor, configúralo.');\n  }\n\n  const recipients = await getRecipients(recipientData);\n  // Obtiene la lista de destinatarios utilizando la función getRecipients.\n  if (recipients.length === 0) {\n    return { success: true, message: `No se encontraron destinatarios. No se enviaron correos.`, stats: { sentCount: 0, failedCount: 0, totalRecipients: 0, duration: 0 } };\n  }\n  // Si no se encontraron destinatarios, retorna un resultado exitoso con estadísticas de cero envíos.\n\n  // Busca el evento correspondiente si se proporcionó un eventId.\n  const event = eventId ? events.find(e => e.id === eventId) : null;\n  // Obtiene el número total de destinatarios.\n  const totalRecipients = recipients.length;\n  // Obtiene una instancia del cliente de Microsoft Graph.\n  const graphClient = await getGraphClient();\n  let sentCount = 0;\n  let failedCount = 0;\n\n  const recipientBatches = [];\n  for (let i = 0; i < recipients.length; i += batchSize) {\n    recipientBatches.push(recipients.slice(i, i + batchSize));\n  }\n  // Divide la lista de destinatarios en lotes según el tamaño de lote especificado.\n\n  // Itera sobre cada lote de destinatarios.\n  for (const [index, batch] of recipientBatches.entries()) {\n    // Itera sobre cada contacto dentro del lote actual.\n    for (const contact of batch) {\n        try {\n            // Inicializa el cuerpo final del correo con el cuerpo HTML original.\n            let finalHtmlBody = htmlBody;\n            // Reemplaza el placeholder {{contact.name}} si existe el nombre del contacto.\n            if (contact.name) {\n              finalHtmlBody = finalHtmlBody.replace(/{{contact.name}}/g, contact.name);\n            }\n            // Reemplaza el placeholder {{event.date}} si existe la fecha del evento.\n            if (event) {\n              finalHtmlBody = finalHtmlBody.replace(/{{event.date}}/g, event.date);\n            }\n            // Limpia cualquier marcador de posición que no haya sido reemplazado.\n            finalHtmlBody = finalHtmlBody.replace(/{{contact.name}}/g, '');\n            finalHtmlBody = finalHtmlBody.replace(/{{event.date}}/g, '');\n\n            const message = {\n                subject: subject,\n                body: { contentType: 'HTML', content: finalHtmlBody },\n                toRecipients: [{ emailAddress: { address: contact.email } }],\n                attachments: attachment ? [\n                  {\n                      '@odata.type': '#microsoft.graph.fileAttachment',\n                      name: attachment.filename,\n                      contentType: attachment.contentType,\n                      contentBytes: attachment.content,\n                  }\n                ] : undefined,\n            };\n            \n            // Envía el correo usando la función con lógica de reintentos.\n            await sendEmailWithRetry(graphClient, message, senderEmail);\n\n            sentCount++;\n            // Incrementa el contador de correos enviados exitosamente.\n        } catch (error) {\n            failedCount++;\n            const errorMessage = (error as any)?.body ? JSON.parse((error as any).body).error.message : (error as Error).message;\n            console.error(`Error al enviar correo a ${contact.email} usando Graph:`, errorMessage);\n            // Incrementa el contador de correos fallidos.\n            // Loguea el error detallado al enviar el correo a un contacto específico.\n        }\n        \n        if(emailDelay > 0) await delay(emailDelay);\n    }\n    \n    if (index < recipientBatches.length - 1) {\n      if(batchDelay > 0) await delay(batchDelay * 1000);\n      // Si no es el último lote y hay un retraso de lote configurado, espera antes de procesar el siguiente lote.\n    }\n  }\n\n  // Registra el tiempo de finalización.\n  const endTime = Date.now();\n  // Calcula la duración total del proceso de envío en segundos.\n  const duration = (endTime - startTime) / 1000;\n\n  let message = `Envío completado con Microsoft Graph. Enviados: ${sentCount}. Fallidos: ${failedCount}.`;\n  if (failedCount > 0) {\n    message += ' Revisa la consola del servidor para más detalles sobre los errores.';\n  }\n\n  // Retorna un objeto con el estado de éxito, un mensaje resumen y estadísticas del envío.\n  return { success: true, message, stats: { sentCount, failedCount, totalRecipients, duration } };\n}\n"],"names":[],"mappings":";;;;;;IAuOsB,eAAA,WAAA,GAAA,CAAA,GAAA,sNAAA,CAAA,wBAAA,EAAA,8CAAA,sNAAA,CAAA,aAAA,EAAA,KAAA,GAAA,sNAAA,CAAA,mBAAA,EAAA","debugId":null}},
    {"offset": {"line": 639, "column": 0}, "map": {"version":3,"sources":["file:///home/user/studio/src/app/actions/send-test-email-action.ts"],"sourcesContent":["\n'use server';\n\nimport 'isomorphic-fetch';\nimport { ClientSecretCredential } from '@azure/identity';\nimport { Client } from '@microsoft/microsoft-graph-client';\nimport { TokenCredentialAuthenticationProvider } from '@microsoft/microsoft-graph-client/authProviders/azureTokenCredentials';\nimport { format } from 'date-fns';\nimport { es } from 'date-fns/locale';\nimport { events } from '@/lib/data';\nimport { hasPermission, APP_PERMISSIONS, type Role } from '@/lib/permissions';\n\n/**\n * @fileoverview Acción de servidor para enviar un único correo de prueba.\n * Incluye verificación de permisos basada en rol.\n */\n\ninterface SendTestEmailPayload {\n  subject: string;\n  htmlBody: string;\n  recipientEmail: string;\n  senderEmail: string;\n  attachment?: {\n    filename: string;\n    contentType: string;\n    content: string; // base64 content\n  };\n  eventId?: string;\n  role: Role;\n}\n\nasync function getGraphClient() {\n    const { GRAPH_CLIENT_ID, GRAPH_TENANT_ID, GRAPH_CLIENT_SECRET } = process.env;\n    if (!GRAPH_CLIENT_ID || !GRAPH_TENANT_ID || !GRAPH_CLIENT_SECRET) {\n        throw new Error('Faltan las variables de entorno de Microsoft Graph. Por favor, configúralas en Ajustes.');\n    }\n    const credential = new ClientSecretCredential(GRAPH_TENANT_ID, GRAPH_CLIENT_ID, GRAPH_CLIENT_SECRET);\n    const authProvider = new TokenCredentialAuthenticationProvider(credential, { scopes: ['https://graph.microsoft.com/.default'] });\n    return Client.initWithMiddleware({ authProvider });\n}\n\nexport async function sendTestEmailAction(payload: SendTestEmailPayload): Promise<{ success: boolean }> {\n  const { subject, htmlBody, recipientEmail, senderEmail, attachment, eventId, role } = payload;\n  \n  if (!hasPermission(role, APP_PERMISSIONS.SEND_CAMPAIGN)) {\n    throw new Error('Acceso denegado: No tienes permiso para enviar correos de prueba.');\n  }\n\n  if (!senderEmail) {\n    throw new Error('Falta el correo del remitente. Por favor, configúralo.');\n  }\n\n  const event = eventId ? events.find(e => e.id === eventId) : null;\n  \n  let finalHtmlBody = htmlBody;\n  // Replace placeholders with test data\n  finalHtmlBody = finalHtmlBody.replace(/{{contact.name}}/g, 'Usuario de Prueba');\n  if (event) {\n    finalHtmlBody = finalHtmlBody.replace(/{{event.date}}/g, event.date);\n  } else {\n    // If no event, use today's date for placeholder\n    finalHtmlBody = finalHtmlBody.replace(/{{event.date}}/g, format(new Date(), 'PPP', { locale: es }));\n  }\n  // Clean up any other unreplaced placeholders\n  finalHtmlBody = finalHtmlBody.replace(/{{contact.name}}/g, '');\n  finalHtmlBody = finalHtmlBody.replace(/{{event.date}}/g, '');\n\n\n  const message = {\n    subject: `[PRUEBA] ${subject}`,\n    body: { contentType: 'HTML', content: finalHtmlBody },\n    toRecipients: [{ emailAddress: { address: recipientEmail } }],\n    attachments: attachment ? [\n      {\n          '@odata.type': '#microsoft.graph.fileAttachment',\n          name: attachment.filename,\n          contentType: attachment.contentType,\n          contentBytes: attachment.content,\n      }\n    ] : undefined,\n  };\n\n  try {\n    const graphClient = await getGraphClient();\n    await graphClient.api(`/users/${senderEmail}/sendMail`).post({ message, saveToSentItems: 'true' });\n    return { success: true };\n  } catch (error) {\n    const errorMessage = (error as any)?.body ? JSON.parse((error as any).body).error.message : (error as Error).message;\n    console.error(`Error al enviar correo de prueba a ${recipientEmail} usando Graph:`, errorMessage);\n    throw new Error(`No se pudo enviar el correo de prueba: ${errorMessage}`);\n  }\n}\n"],"names":[],"mappings":";;;;;;IAyCsB,sBAAA,WAAA,GAAA,CAAA,GAAA,sNAAA,CAAA,wBAAA,EAAA,8CAAA,sNAAA,CAAA,aAAA,EAAA,KAAA,GAAA,sNAAA,CAAA,mBAAA,EAAA","debugId":null}},
    {"offset": {"line": 652, "column": 0}, "map": {"version":3,"sources":["file:///home/user/studio/src/components/ui/label.tsx"],"sourcesContent":["/**\n * @fileoverview Componente de UI \"Label\" (Etiqueta).\n * Muestra una etiqueta para un campo de formulario.\n *\n * @see https://ui.shadcn.com/docs/components/label\n */\n\"use client\"\n\nimport * as React from \"react\"\nimport * as LabelPrimitive from \"@radix-ui/react-label\"\nimport { cva, type VariantProps } from \"class-variance-authority\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst labelVariants = cva(\n  \"text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70\"\n)\n\n/**\n * Componente Label que se asocia con un campo de entrada.\n */\nconst Label = React.forwardRef<\n  React.ElementRef<typeof LabelPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof LabelPrimitive.Root> &\n    VariantProps<typeof labelVariants>\n>(({ className, ...props }, ref) => (\n  <LabelPrimitive.Root\n    ref={ref}\n    className={cn(labelVariants(), className)}\n    {...props}\n  />\n))\nLabel.displayName = LabelPrimitive.Root.displayName\n\nexport { Label }\n"],"names":[],"mappings":"AAAA;;;;;CAKC;;;;AAGD;AACA;AACA;AAEA;AANA;;;;;;AAQA,MAAM,gBAAgB,CAAA,GAAA,gKAAA,CAAA,MAAG,AAAD,EACtB;AAGF;;CAEC,GACD,MAAM,sBAAQ,CAAA,GAAA,qMAAA,CAAA,aAAgB,AAAD,EAI3B,CAAC,EAAE,SAAS,EAAE,GAAG,OAAO,EAAE,oBAC1B,8OAAC,iKAAA,CAAA,OAAmB;QAClB,KAAK;QACL,WAAW,CAAA,GAAA,mHAAA,CAAA,KAAE,AAAD,EAAE,iBAAiB;QAC9B,GAAG,KAAK;;;;;;AAGb,MAAM,WAAW,GAAG,iKAAA,CAAA,OAAmB,CAAC,WAAW","debugId":null}},
    {"offset": {"line": 691, "column": 0}, "map": {"version":3,"sources":["file:///home/user/studio/src/components/ui/textarea.tsx"],"sourcesContent":["/**\n * @fileoverview Componente de UI \"Textarea\".\n * Proporciona un campo de entrada de texto de varias líneas.\n *\n * @see https://ui.shadcn.com/docs/components/textarea\n */\nimport * as React from 'react';\n\nimport {cn} from '@/lib/utils';\n\n/**\n * Componente Textarea para entrada de texto largo.\n */\nconst Textarea = React.forwardRef<HTMLTextAreaElement, React.ComponentProps<'textarea'>>(\n  ({className, ...props}, ref) => {\n    return (\n      <textarea\n        className={cn(\n          'flex min-h-[80px] w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm',\n          className\n        )}\n        ref={ref}\n        {...props}\n      />\n    );\n  }\n);\nTextarea.displayName = 'Textarea';\n\nexport {Textarea};\n"],"names":[],"mappings":"AAAA;;;;;CAKC;;;;AACD;AAEA;;;;AAEA;;CAEC,GACD,MAAM,yBAAW,CAAA,GAAA,qMAAA,CAAA,aAAgB,AAAD,EAC9B,CAAC,EAAC,SAAS,EAAE,GAAG,OAAM,EAAE;IACtB,qBACE,8OAAC;QACC,WAAW,CAAA,GAAA,mHAAA,CAAA,KAAE,AAAD,EACV,qTACA;QAEF,KAAK;QACJ,GAAG,KAAK;;;;;;AAGf;AAEF,SAAS,WAAW,GAAG","debugId":null}},
    {"offset": {"line": 726, "column": 0}, "map": {"version":3,"sources":["file:///home/user/studio/src/components/ui/tabs.tsx"],"sourcesContent":["/**\n * @fileoverview Componente de UI \"Tabs\" (Pestañas).\n * Un conjunto de pestañas que muestran un panel de contenido a la vez.\n *\n * @see https://ui.shadcn.com/docs/components/tabs\n */\n\"use client\"\n\nimport * as React from \"react\"\nimport * as TabsPrimitive from \"@radix-ui/react-tabs\"\n\nimport { cn } from \"@/lib/utils\"\n\n/**\n * Componente raíz del sistema de pestañas.\n */\nconst Tabs = TabsPrimitive.Root\n\n/**\n * Lista que contiene los disparadores de las pestañas.\n */\nconst TabsList = React.forwardRef<\n  React.ElementRef<typeof TabsPrimitive.List>,\n  React.ComponentPropsWithoutRef<typeof TabsPrimitive.List>\n>(({ className, ...props }, ref) => (\n  <TabsPrimitive.List\n    ref={ref}\n    className={cn(\n      \"inline-flex h-10 items-center justify-center rounded-md bg-muted p-1 text-muted-foreground\",\n      className\n    )}\n    {...props}\n  />\n))\nTabsList.displayName = TabsPrimitive.List.displayName\n\n/**\n * El botón que activa una pestaña para mostrar su contenido.\n */\nconst TabsTrigger = React.forwardRef<\n  React.ElementRef<typeof TabsPrimitive.Trigger>,\n  React.ComponentPropsWithoutRef<typeof TabsPrimitive.Trigger>\n>(({ className, ...props }, ref) => (\n  <TabsPrimitive.Trigger\n    ref={ref}\n    className={cn(\n      \"inline-flex items-center justify-center whitespace-nowrap rounded-sm px-3 py-1.5 text-sm font-medium ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:bg-background data-[state=active]:text-foreground data-[state=active]:shadow-sm\",\n      className\n    )}\n    {...props}\n  />\n))\nTabsTrigger.displayName = TabsPrimitive.Trigger.displayName\n\n/**\n * El panel de contenido asociado a una pestaña.\n */\nconst TabsContent = React.forwardRef<\n  React.ElementRef<typeof TabsPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof TabsPrimitive.Content>\n>(({ className, ...props }, ref) => (\n  <TabsPrimitive.Content\n    ref={ref}\n    className={cn(\n      \"mt-2 ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2\",\n      className\n    )}\n    {...props}\n  />\n))\nTabsContent.displayName = TabsPrimitive.Content.displayName\n\nexport { Tabs, TabsList, TabsTrigger, TabsContent }\n"],"names":[],"mappings":"AAAA;;;;;CAKC;;;;;;;AAGD;AACA;AAEA;AALA;;;;;AAOA;;CAEC,GACD,MAAM,OAAO,gKAAA,CAAA,OAAkB;AAE/B;;CAEC,GACD,MAAM,yBAAW,CAAA,GAAA,qMAAA,CAAA,aAAgB,AAAD,EAG9B,CAAC,EAAE,SAAS,EAAE,GAAG,OAAO,EAAE,oBAC1B,8OAAC,gKAAA,CAAA,OAAkB;QACjB,KAAK;QACL,WAAW,CAAA,GAAA,mHAAA,CAAA,KAAE,AAAD,EACV,8FACA;QAED,GAAG,KAAK;;;;;;AAGb,SAAS,WAAW,GAAG,gKAAA,CAAA,OAAkB,CAAC,WAAW;AAErD;;CAEC,GACD,MAAM,4BAAc,CAAA,GAAA,qMAAA,CAAA,aAAgB,AAAD,EAGjC,CAAC,EAAE,SAAS,EAAE,GAAG,OAAO,EAAE,oBAC1B,8OAAC,gKAAA,CAAA,UAAqB;QACpB,KAAK;QACL,WAAW,CAAA,GAAA,mHAAA,CAAA,KAAE,AAAD,EACV,uYACA;QAED,GAAG,KAAK;;;;;;AAGb,YAAY,WAAW,GAAG,gKAAA,CAAA,UAAqB,CAAC,WAAW;AAE3D;;CAEC,GACD,MAAM,4BAAc,CAAA,GAAA,qMAAA,CAAA,aAAgB,AAAD,EAGjC,CAAC,EAAE,SAAS,EAAE,GAAG,OAAO,EAAE,oBAC1B,8OAAC,gKAAA,CAAA,UAAqB;QACpB,KAAK;QACL,WAAW,CAAA,GAAA,mHAAA,CAAA,KAAE,AAAD,EACV,mIACA;QAED,GAAG,KAAK;;;;;;AAGb,YAAY,WAAW,GAAG,gKAAA,CAAA,UAAqB,CAAC,WAAW","debugId":null}},
    {"offset": {"line": 800, "column": 0}, "map": {"version":3,"sources":["file:///home/user/studio/src/app/%28main%29/send/page.tsx"],"sourcesContent":["\n\"use client\";\n\nimport { Button } from \"@/components/ui/button\";\nimport {\n  Card,\n  CardContent,\n  CardDescription,\n  CardFooter,\n  CardHeader,\n  CardTitle,\n} from \"@/components/ui/card\";\nimport {\n  Select,\n  SelectContent,\n  SelectItem,\n  SelectTrigger,\n  SelectValue,\n} from \"@/components/ui/select\";\nimport {\n  Dialog,\n  DialogContent,\n  DialogDescription,\n  DialogHeader,\n  DialogTitle,\n} from \"@/components/ui/dialog\";\nimport {\n  Calendar as CalendarIcon,\n  Loader2,\n  Users,\n  Clock,\n  AlertTriangle,\n  CheckCircle,\n  TrendingUp,\n  Info,\n  MailPlus,\n  Send,\n  Paperclip,\n  Reply,\n  ReplyAll,\n  Forward,\n  MoreHorizontal,\n  File,\n  Laptop,\n  Smartphone,\n} from \"lucide-react\";\nimport {\n  Popover,\n  PopoverContent,\n  PopoverTrigger,\n} from \"@/components/ui/popover\";\nimport { Avatar, AvatarFallback } from \"@/components/ui/avatar\";\nimport { Calendar } from \"@/components/ui/calendar\";\nimport { useState, useEffect, useMemo } from \"react\";\nimport { format } from \"date-fns\";\nimport { es } from \"date-fns/locale\";\nimport { templates, events, surveys, certificateTemplates } from \"@/lib/data\";\nimport { useToast } from \"@/hooks/use-toast\";\nimport { sendCampaign } from \"@/app/actions/send-campaign-action\";\nimport { sendTestEmailAction } from \"@/app/actions/send-test-email-action\";\nimport { Label } from \"@/components/ui/label\";\nimport { Textarea } from \"@/components/ui/textarea\";\nimport { Input } from \"@/components/ui/input\";\nimport { Tabs, TabsContent, TabsList, TabsTrigger } from \"@/components/ui/tabs\";\nimport { cn } from \"@/lib/utils\";\nimport { parse } from 'csv-parse/sync';\nimport * as XLSX from 'xlsx';\nimport { jsPDF } from \"jspdf\";\nimport { useAuth } from \"@/context/auth-context\";\nimport { ROLES } from \"@/lib/permissions\";\n\ntype RecipientSource = \"date\" | \"file\" | \"sql\";\ntype ContentType = \"template\" | \"event\" | \"survey\" | \"custom\" | \"certificate\";\n\ninterface CampaignStats {\n  sentCount: number;\n  failedCount: number;\n  totalRecipients: number;\n  duration: number;\n}\n\nconst defaultInitialBody = `<div style=\"font-family: Arial, 'Helvetica Neue', Helvetica, sans-serif; font-size: 16px; line-height: 1.5; color: #333333; background-color: #ffffff; margin: 0; padding: 0;\">\n  <table role=\"presentation\" width=\"100%\" border=\"0\" cellpadding=\"0\" cellspacing=\"0\" style=\"background-color: #ffffff;\">\n    <tr>\n      <td align=\"center\">\n        <table role=\"presentation\" width=\"600\" border=\"0\" cellpadding=\"0\" cellspacing=\"0\" class=\"content-table\" style=\"width: 100%; max-width: 600px; margin: 0 auto;\">\n          <!-- Header -->\n          <tr>\n            <td>\n              <img src=\"https://placehold.co/600x95.png\" alt=\"Header Banner\" style=\"width: 100%; height: auto; display: block;\" data-ai-hint=\"papalote museum header\" />\n            </td>\n          </tr>\n          <!-- Body -->\n          <tr>\n            <td style=\"padding: 30px 20px;\">\n              <p style=\"margin: 0 0 16px 0;\"><strong>Maestra, Maestro:</strong></p>\n              <p style=\"margin: 0 0 16px 0;\">Nos alegra mucho que hayas utilizado nuestra página para planear tu visita a Papalote Museo del Niño.</p>\n              <p style=\"margin: 0 0 16px 0;\">En este correo encontrarás adjuntos:</p>\n              <ul style=\"margin: 0 0 16px 0; padding-left: 20px;\">\n                <li style=\"margin-bottom: 8px;\">Formato Proyecto de visita (prellenado)</li>\n                <li style=\"margin-bottom: 8px;\">Formatos administrativos</li>\n              </ul>\n              <p style=\"margin: 0 0 16px 0;\">Esperamos que estas herramientas te ayuden a detonar proyectos increíbles y faciliten la visita con tu grupo escolar.</p>\n              \n              <table role=\"presentation\" width=\"100%\" border=\"0\" cellpadding=\"0\" cellspacing=\"0\">\n                <tr>\n                  <td valign=\"top\" style=\"padding-right: 20px; width: 60%;\">\n                    <p style=\"margin: 0 0 16px 0;\"><strong>Si requieres más información:</strong></p>\n                    <p style=\"margin: 0 0 8px 0;\">Llámanos a: 5552371710 - 5546017873</p>\n                    <p style=\"margin: 0 0 16px 0;\">O escríbenos un whatsApp.</p>\n                    <p style=\"margin: 0 0 16px 0;\">\n                      <img src=\"https://placehold.co/40x40.png\" alt=\"WhatsApp\" width=\"30\" height=\"30\" style=\"vertical-align: middle;\" data-ai-hint=\"whatsapp logo\" />\n                    </p>\n                    <p style=\"margin: 0;\"><strong>¡Nos vemos muy pronto!</strong></p>\n                  </td>\n                  <td width=\"40%\" valign=\"top\" align=\"center\">\n                    <img src=\"https://placehold.co/200x150.png\" alt=\"¡No olvides descargar la guía educativa! Da clic aquí\" style=\"max-width: 100%; height: auto; display: block;\" data-ai-hint=\"educational guide monster\" />\n                  </td>\n                </tr>\n              </table>\n            </td>\n          </tr>\n          <!-- Footer -->\n          <tr>\n            <td>\n              <img src=\"https://placehold.co/600x50.png\" alt=\"Footer Banner\" style=\"width: 100%; height: auto; display: block;\" data-ai-hint=\"papalote museum footer\" />\n            </td>\n          </tr>\n        </table>\n      </td>\n    </tr>\n  </table>\n</div>`;\n\n/**\n * Página de Nuevo Correo.\n * Permite a los usuarios componer un nuevo envío de correo, seleccionar plantillas,\n * definir destinatarios y configurar los parámetros de envío.\n */\nexport default function SendPage() {\n  const [date, setDate] = useState<Date>();\n  const [isSending, setIsSending] = useState(false);\n  const [isSendingTest, setIsSendingTest] = useState(false);\n  const { toast } = useToast();\n  const { role } = useAuth();\n  \n  const [senderEmail, setSenderEmail] = useState(\"\");\n  const [testEmail, setTestEmail] = useState(\"\");\n\n  const [subject, setSubject] = useState(\"\");\n  const [emailBody, setEmailBody] = useState(\"\");\n  const [recipientSource, setRecipientSource] = useState<RecipientSource>(\"file\");\n  const [fileContent, setFileContent] = useState(\"\");\n  const [uploadedFileType, setUploadedFileType] = useState<\"csv\" | \"excel\" | null>(null);\n  const [sqlQuery, setSqlQuery] = useState(\"SELECT email, name FROM contacts WHERE subscribed = TRUE;\");\n  const [lastRunStats, setLastRunStats] = useState<CampaignStats | null>(null);\n  \n  const [recipientCount, setRecipientCount] = useState(0);\n\n  // Content type selection\n  const [contentType, setContentType] = useState<ContentType>(\"template\");\n  const [selectedTemplateId, setSelectedTemplateId] = useState<string>(templates[0]?.id || \"\");\n  const [selectedEventId, setSelectedEventId] = useState<string>(\"\");\n  const [selectedSurveyId, setSelectedSurveyId] = useState<string>(\"\");\n  const [attachmentName, setAttachmentName] = useState<string | null>(null);\n  const [certificatePreview, setCertificatePreview] = useState<string | null>(null);\n  const [previewMode, setPreviewMode] = useState<'desktop' | 'mobile'>('desktop');\n\n  useEffect(() => {\n    if (role) {\n      const userEmail = `${role}@email.com`;\n      setSenderEmail(userEmail);\n      setTestEmail(userEmail);\n    }\n  }, [role]);\n\n  useEffect(() => {\n    setAttachmentName(null);\n    setCertificatePreview(null);\n    \n    if (contentType === 'custom') {\n        setSubject(\"Asunto Personalizado\");\n        setEmailBody(defaultInitialBody);\n    } else if (contentType === \"template\" && selectedTemplateId) {\n        const template = templates.find(t => t.id === selectedTemplateId);\n        if (template) {\n            setSubject(`Desde plantilla: ${template.name}`);\n            setEmailBody(`<h1>${template.name}</h1><p>${template.description}</p><p>Este es un cuerpo de correo basado en una plantilla.</p>`);\n        }\n    } else if (contentType === \"event\" && selectedEventId) {\n        const event = events.find(e => e.id === selectedEventId);\n        if(event) {\n            setSubject(`Invitación al evento: ${event.name}`);\n            setEmailBody(`<h1>Invitación a ${event.name}</h1><p>Estás invitado a nuestro próximo evento el ${event.date}. ¡No te lo pierdas!</p>`);\n        }\n    } else if (contentType === \"survey\" && selectedSurveyId) {\n        const survey = surveys.find(s => s.id === selectedSurveyId);\n        if (survey) {\n            setSubject(`Participa en nuestra encuesta: ${survey.name}`);\n            setEmailBody(`<h1>${survey.name}</h1><p>Tu opinión es importante. <a href=\"#\">Haz clic aquí para participar</a>.</p>`);\n        }\n    } else if (contentType === \"certificate\" && selectedEventId) {\n      const event = events.find(e => e.id === selectedEventId);\n      const template = certificateTemplates[selectedEventId as keyof typeof certificateTemplates];\n      if (event && template) {\n          setSubject(`Tu certificado del evento: ${event.name}`);\n          setEmailBody(`<h1>¡Felicidades! Aquí está tu certificado</h1><p>Hola {{contact.name}},</p><p>Gracias por tu participación en el evento \"${event.name}\" el {{event.date}}. Adjuntamos tu certificado de asistencia.</p><p>¡Esperamos verte de nuevo!</p>`);\n          setAttachmentName(`certificado-${event.name.replace(/\\s/g, '_')}.pdf`);\n          setCertificatePreview(`data:image/png;base64,${template}`);\n      }\n    } else {\n        setSubject(\"\");\n        setEmailBody(\"\");\n    }\n  }, [contentType, selectedTemplateId, selectedEventId, selectedSurveyId]);\n\n  const estimatedTime = useMemo(() => {\n    const batchSize = 50;\n    const emailDelay = 100;\n    const batchDelay = 5;\n\n    if (recipientCount === 0 || batchSize <= 0) return \"0s\";\n    const totalEmailDelaySeconds = (recipientCount * emailDelay) / 1000;\n    const numberOfBatches = Math.ceil(recipientCount / batchSize);\n    const totalBatchDelaySeconds = (numberOfBatches > 1) ? (numberOfBatches - 1) * batchDelay : 0;\n    const totalSeconds = totalEmailDelaySeconds + totalBatchDelaySeconds;\n\n    if (totalSeconds < 60) return `${totalSeconds.toFixed(1)}s`;\n    const minutes = Math.floor(totalSeconds / 60);\n    const seconds = (totalSeconds % 60).toFixed(0);\n    return `${minutes}m ${seconds}s`;\n  }, [recipientCount]);\n\n  const handleFileChange = (e: React.ChangeEvent<HTMLInputElement>) => {\n    const file = e.target.files?.[0];\n    if (file) {\n      const reader = new FileReader();\n      const fileName = file.name.toLowerCase();\n      setRecipientCount(0);\n      const resetState = () => { e.target.value = ''; setFileContent(\"\"); setUploadedFileType(null); setRecipientCount(0); };\n\n      if (fileName.endsWith(\".csv\")) {\n        setUploadedFileType(\"csv\");\n        reader.onload = (event) => {\n          const content = event.target?.result as string;\n          setFileContent(content);\n          try { setRecipientCount(parse(content, { columns: true, skip_empty_lines: true }).length); } catch { setRecipientCount(0); }\n        };\n        reader.readAsText(file);\n      } else if (fileName.endsWith(\".xls\") || fileName.endsWith(\".xlsx\")) {\n        setUploadedFileType(\"excel\");\n        reader.onload = (event) => {\n          const buffer = event.target?.result as ArrayBuffer;\n          const base64 = Buffer.from(buffer).toString('base64');\n          setFileContent(base64);\n          try {\n            const workbook = XLSX.read(buffer, { type: 'buffer' });\n            const jsonData: any[] = XLSX.utils.sheet_to_json(workbook.Sheets[workbook.SheetNames[0]]);\n            setRecipientCount(jsonData.length);\n          } catch { setRecipientCount(0); }\n        };\n        reader.readAsArrayBuffer(file);\n      } else {\n        toast({ title: \"Archivo no válido\", description: \"Por favor, selecciona un archivo .csv, .xls o .xlsx.\", variant: \"destructive\" });\n        resetState();\n      }\n    }\n  };\n  \n  const handleHtmlFileChange = (e: React.ChangeEvent<HTMLInputElement>) => {\n    const file = e.target.files?.[0];\n    if (file && file.name.endsWith(\".html\")) {\n      const reader = new FileReader();\n      reader.onload = (event) => { setEmailBody(event.target?.result as string); toast({ title: \"HTML Cargado\" }); };\n      reader.readAsText(file);\n      setContentType(\"custom\");\n    } else {\n      toast({ title: \"Archivo no válido\", description: \"Por favor, selecciona un archivo .html.\", variant: \"destructive\" });\n    }\n    e.target.value = \"\";\n  };\n\n  const handleSendTestEmail = async () => {\n    if (!testEmail.trim() || !senderEmail.trim() || !subject.trim() || !emailBody.trim()) {\n      toast({ title: \"Faltan datos\", description: \"Asegúrate de que el remitente, asunto, cuerpo y correo de prueba estén completos.\", variant: \"destructive\" });\n      return;\n    }\n    if (!role) {\n      toast({ title: \"Error de autenticación\", description: \"No se pudo verificar el rol del usuario.\", variant: \"destructive\" });\n      return;\n    }\n\n    setIsSendingTest(true);\n    try {\n      let attachment;\n      if (contentType === 'certificate' && selectedEventId) {\n          const template = certificateTemplates[selectedEventId as keyof typeof certificateTemplates];\n          const event = events.find(e => e.id === selectedEventId);\n          if (template && event) {\n              const pdf = new jsPDF('l', 'px', [1100, 850]);\n              const dataUrl = `data:image/png;base64,${template}`;\n              pdf.addImage(dataUrl, 'PNG', 0, 0, pdf.internal.pageSize.getWidth(), pdf.internal.pageSize.getHeight());\n              pdf.text(`Otorgado a: Usuario de Prueba`, 550, 450, { align: 'center' });\n              const pdfBase64 = pdf.output('datauristring').split(',')[1];\n              attachment = {\n                  content: pdfBase64,\n                  filename: `certificado-${event.name.replace(/ /g, '_')}.pdf`,\n                  contentType: 'application/pdf'\n              }\n          }\n      }\n\n      await sendTestEmailAction({\n        subject,\n        htmlBody: emailBody,\n        recipientEmail: testEmail,\n        senderEmail,\n        attachment,\n        eventId: selectedEventId,\n        role,\n      });\n\n      toast({ title: \"Correo de prueba enviado\", description: `Se ha enviado un correo de prueba a ${testEmail}.` });\n    } catch (error) {\n      toast({ title: \"Error al enviar prueba\", description: (error as Error).message, variant: \"destructive\" });\n    } finally {\n      setIsSendingTest(false);\n    }\n  };\n\n  const handleSendCampaign = async () => {\n    setLastRunStats(null);\n    if (!subject.trim() || !senderEmail.trim() || !emailBody.trim()) {\n      toast({ title: \"Remitente, Asunto y Cuerpo requeridos\", variant: \"destructive\" });\n      return;\n    }\n    if (!role) {\n      toast({ title: \"Error de autenticación\", description: \"No se pudo verificar el rol del usuario.\", variant: \"destructive\" });\n      return;\n    }\n    let recipientData;\n    switch (recipientSource) {\n      case \"date\": recipientData = { type: \"date\" as const, value: format(date!, \"dd/MM/yyyy\") }; break;\n      case \"file\": recipientData = { type: uploadedFileType!, value: fileContent }; break;\n      case \"sql\": recipientData = { type: \"sql\" as const, value: sqlQuery }; break;\n    }\n\n    let attachment;\n    if (contentType === 'certificate' && selectedEventId) {\n        const template = certificateTemplates[selectedEventId as keyof typeof certificateTemplates];\n        const event = events.find(e => e.id === selectedEventId);\n        if (template && event) {\n            const pdf = new jsPDF('l', 'px', [1100, 850]);\n            const dataUrl = `data:image/png;base64,${template}`;\n            pdf.addImage(dataUrl, 'PNG', 0, 0, pdf.internal.pageSize.getWidth(), pdf.internal.pageSize.getHeight());\n            const pdfBase64 = pdf.output('datauristring').split(',')[1];\n            attachment = {\n                content: pdfBase64,\n                filename: `certificado-${event.name.replace(/ /g, '_')}.pdf`,\n                contentType: 'application/pdf'\n            }\n        } else {\n            toast({ title: \"Plantilla no encontrada\", description: \"No se encontró una plantilla de certificado para este evento.\", variant: \"destructive\" });\n            return;\n        }\n    }\n\n    setIsSending(true);\n    try {\n      const result = await sendCampaign({ \n        subject, \n        htmlBody: emailBody, \n        recipientData, \n        senderEmail,\n        attachment,\n        eventId: selectedEventId,\n        role,\n      });\n      toast({ title: \"Proceso de envío finalizado\", description: result.message });\n      if (result.stats) setLastRunStats(result.stats);\n    } catch (error) {\n      toast({ title: \"Error al enviar\", description: (error as Error).message, variant: \"destructive\" });\n    } finally {\n      setIsSending(false);\n    }\n  };\n\n  const renderContentSelector = () => {\n    switch (contentType) {\n        case 'template':\n            return <Select value={selectedTemplateId} onValueChange={setSelectedTemplateId}><SelectTrigger><SelectValue placeholder=\"Elige una plantilla...\" /></SelectTrigger><SelectContent>{templates.map(t => <SelectItem key={t.id} value={t.id}>{t.name}</SelectItem>)}</SelectContent></Select>;\n        case 'event':\n            return <Select onValueChange={setSelectedEventId}><SelectTrigger><SelectValue placeholder=\"Elige un evento para la invitación...\" /></SelectTrigger><SelectContent>{events.map(e => <SelectItem key={e.id} value={e.id}>{e.name}</SelectItem>)}</SelectContent></Select>;\n        case 'survey':\n            return <Select onValueChange={setSelectedSurveyId}><SelectTrigger><SelectValue placeholder=\"Elige una encuesta...\" /></SelectTrigger><SelectContent>{surveys.map(s => <SelectItem key={s.id} value={s.id}>{s.name}</SelectItem>)}</SelectContent></Select>;\n        case 'certificate':\n            return <Select onValueChange={setSelectedEventId}><SelectTrigger><SelectValue placeholder=\"Elige un evento para el certificado...\" /></SelectTrigger><SelectContent>{events.map(e => <SelectItem key={e.id} value={e.id}>{e.name}</SelectItem>)}</SelectContent></Select>;\n        default:\n            return null;\n    }\n  }\n\n  return (\n    <div className=\"space-y-6\">\n      <div className=\"flex items-center justify-between\">\n        <div>\n          <h1 className=\"text-3xl font-headline font-bold\">Nuevo Correo</h1>\n          <p className=\"text-muted-foreground\">\n            Compón y envía un nuevo correo electrónico masivo.\n          </p>\n        </div>\n      </div>\n\n      <div className=\"grid lg:grid-cols-2 gap-8 items-start\">\n        <Card>\n          <CardHeader>\n            <CardTitle>Composición y Configuración</CardTitle>\n          </CardHeader>\n          <CardContent className=\"space-y-6\">\n            \n            <div className=\"space-y-4\">\n                <div className=\"space-y-2\">\n                    <Label>Tipo de Contenido</Label>\n                    <Select value={contentType} onValueChange={(v) => setContentType(v as ContentType)}>\n                        <SelectTrigger><SelectValue /></SelectTrigger>\n                        <SelectContent>\n                            <SelectItem value=\"template\">Usar Plantilla</SelectItem>\n                            <SelectItem value=\"event\">Invitación a Evento</SelectItem>\n                            <SelectItem value=\"survey\">Enviar Encuesta</SelectItem>\n                            <SelectItem value=\"certificate\">Certificado de Evento</SelectItem>\n                            <SelectItem value=\"custom\">Personalizado (HTML)</SelectItem>\n                        </SelectContent>\n                    </Select>\n                </div>\n                {contentType !== 'custom' && <div className=\"space-y-2\">{renderContentSelector()}</div>}\n            </div>\n\n            <div className=\"space-y-4 border-t pt-4\">\n              <div className=\"grid md:grid-cols-2 gap-4\">\n                  <div className=\"space-y-2\">\n                      <Label htmlFor=\"sender-email\">Email del Remitente</Label>\n                      <Input id=\"sender-email\" type=\"email\" value={senderEmail} onChange={(e) => setSenderEmail(e.target.value)} />\n                  </div>\n                  <div className=\"space-y-2\">\n                      <Label htmlFor=\"subject\">Asunto del Correo</Label>\n                      <Input id=\"subject\" value={subject} onChange={(e) => setSubject(e.target.value)} />\n                  </div>\n              </div>\n\n              <div className=\"space-y-2\">\n                <div className=\"flex justify-between items-center\">\n                  <Label>Cuerpo del Mensaje</Label>\n                   <div className={cn(\"flex items-center gap-2\", contentType !== 'custom' && 'hidden')}>\n                    <Label htmlFor=\"html-upload\" className=\"text-sm font-normal text-primary underline-offset-4 hover:underline cursor-pointer\">O sube HTML</Label>\n                    <Input id=\"html-upload\" type=\"file\" accept=\".html\" className=\"hidden\" onChange={handleHtmlFileChange} />\n                   </div>\n                </div>\n                <Textarea value={emailBody} onChange={(e) => setEmailBody(e.target.value)} rows={10} disabled={contentType !== 'custom'} />\n              </div>\n            </div>\n            \n            <div className=\"space-y-2\">\n              <Label>Fuente de Destinatarios</Label>\n              <Tabs value={recipientSource} onValueChange={(v) => setRecipientSource(v as RecipientSource)} className=\"w-full\">\n                <TabsList className={cn(\n                  \"grid w-full\",\n                  role === ROLES.IT ? \"grid-cols-3\" : \"grid-cols-2\"\n                )}>\n                  <TabsTrigger value=\"date\">Fecha de Visita</TabsTrigger>\n                  <TabsTrigger value=\"file\">Subir Archivo</TabsTrigger>\n                  {role === ROLES.IT && <TabsTrigger value=\"sql\">Consulta SQL</TabsTrigger>}\n                </TabsList>\n                <TabsContent value=\"date\" className=\"mt-4 border-t pt-4\"><Popover><PopoverTrigger asChild><Button variant={\"outline\"} className=\"w-[280px] justify-start text-left font-normal\"><CalendarIcon className=\"mr-2 h-4 w-4\" />{date ? format(date, \"PPP\", { locale: es }) : <span>Elige una fecha</span>}</Button></PopoverTrigger><PopoverContent className=\"w-auto p-0\"><Calendar mode=\"single\" selected={date} onSelect={setDate} initialFocus locale={es} /></PopoverContent></Popover></TabsContent>\n                <TabsContent value=\"file\" className=\"mt-4 space-y-2 border-t pt-4\"><Label htmlFor=\"file-upload\">Sube un archivo CSV o Excel</Label><Input id=\"file-upload\" type=\"file\" accept=\".csv, application/vnd.openxmlformats-officedocument.spreadsheetml.sheet, application/vnd.ms-excel\" onChange={handleFileChange} /><p className=\"text-sm text-muted-foreground\">El archivo debe contener una columna \"email\".</p></TabsContent>\n                {role === ROLES.IT && <TabsContent value=\"sql\" className=\"mt-4 space-y-2 border-t pt-4\"><Label htmlFor=\"sql-query\">Escribe tu consulta SQL</Label><Textarea id=\"sql-query\" value={sqlQuery} onChange={(e) => setSqlQuery(e.target.value)} rows={4} /><p className=\"text-sm text-muted-foreground\">La consulta debe devolver una columna \"email\".</p></TabsContent>}\n              </Tabs>\n            </div>\n\n            <div className=\"space-y-3 rounded-md border p-4\">\n              <Label>Envío de Prueba</Label>\n              <p className=\"text-sm text-muted-foreground\">\n                Envía una versión de prueba de este correo antes del envío masivo.\n              </p>\n              <div className=\"flex gap-2 items-end\">\n                <div className=\"flex-grow space-y-2\">\n                  <Label htmlFor=\"test-email\" className=\"sr-only\">Correo de Prueba</Label>\n                  <Input id=\"test-email\" type=\"email\" placeholder=\"tu-correo@ejemplo.com\" value={testEmail} onChange={(e) => setTestEmail(e.target.value)} />\n                </div>\n                <Button onClick={handleSendTestEmail} variant=\"secondary\" disabled={isSendingTest || isSending}>\n                  {isSendingTest ? <Loader2 className=\"mr-2 h-4 w-4 animate-spin\" /> : <Send className=\"h-4 w-4\" />}\n                  <span>Enviar Prueba</span>\n                </Button>\n              </div>\n            </div>\n\n            \n            <div className=\"flex items-start space-x-3 rounded-md bg-muted/50 p-3 text-sm\">\n                <Info className=\"h-5 w-5 text-muted-foreground mt-0.5 flex-shrink-0\" />\n                <div>\n                    <p className=\"text-muted-foreground\">Destinatarios detectados: <span className=\"font-bold text-foreground\">{recipientCount}</span></p>\n                    <p className=\"text-muted-foreground\">Tiempo estimado: <span className=\"font-bold text-foreground\">{estimatedTime}</span></p>\n                    <p className=\"text-muted-foreground mt-1 text-xs\">Los ajustes de velocidad de envío se gestionan en la sección de <span className=\"font-bold text-foreground\">Ajustes</span>.</p>\n                </div>\n            </div>\n\n          </CardContent>\n          <CardFooter>\n            <Button onClick={handleSendCampaign} disabled={isSending || isSendingTest} className=\"w-full\">\n              <MailPlus className=\"mr-2 h-4 w-4\" />\n              {isSending ? \"Enviando...\" : \"Iniciar Envío Masivo\"}\n            </Button>\n          </CardFooter>\n        </Card>\n\n        <div className=\"sticky top-24 space-y-8\">\n          <Card>\n            <CardHeader>\n                <div className=\"flex items-center justify-between\">\n                    <div>\n                        <CardTitle>Vista Previa del Correo</CardTitle>\n                        <CardDescription>Así es como los destinatarios verán tu correo.</CardDescription>\n                    </div>\n                    <div className=\"flex items-center gap-1 rounded-md bg-muted p-1\">\n                        <Button variant={previewMode === 'desktop' ? 'secondary' : 'ghost'} size=\"icon\" className=\"h-8 w-8\" onClick={() => setPreviewMode('desktop')} aria-label=\"Vista de escritorio\">\n                            <Laptop className=\"h-4 w-4\" />\n                        </Button>\n                        <Button variant={previewMode === 'mobile' ? 'secondary' : 'ghost'} size=\"icon\" className=\"h-8 w-8\" onClick={() => setPreviewMode('mobile')} aria-label=\"Vista móvil\">\n                            <Smartphone className=\"h-4 w-4\" />\n                        </Button>\n                    </div>\n                </div>\n            </CardHeader>\n            <CardContent>\n                <div className={cn(\n                    \"w-full transition-all duration-300 ease-in-out\",\n                    previewMode === 'mobile' && 'mx-auto w-[375px]'\n                )}>\n                    <div className={cn(\n                        \"rounded-lg border bg-card text-card-foreground shadow-sm overflow-hidden\",\n                        previewMode === 'mobile' && 'border-8 border-black rounded-[40px] shadow-lg'\n                    )}>\n                        {/* Header */}\n                        <div className=\"flex items-center justify-between p-3 border-b bg-muted/30\">\n                            <div className=\"flex items-center gap-3\">\n                                <Avatar className=\"h-8 w-8\">\n                                    <AvatarFallback>AP</AvatarFallback>\n                                </Avatar>\n                                <div>\n                                    <p className=\"font-semibold text-sm\">{senderEmail || 'remitente@ejemplo.com'}</p>\n                                    <p className=\"text-xs text-muted-foreground\">Para: destinatario@ejemplo.com</p>\n                                </div>\n                            </div>\n                            <div className=\"flex items-center gap-1 text-muted-foreground\">\n                                <span className=\"text-xs mr-2\">Ahora</span>\n                                <Button variant=\"ghost\" size=\"icon\" className=\"size-8\"><Reply className=\"size-4\" /></Button>\n                                <Button variant=\"ghost\" size=\"icon\" className=\"size-8\"><ReplyAll className=\"size-4\" /></Button>\n                                <Button variant=\"ghost\" size=\"icon\" className=\"size-8\"><Forward className=\"size-4\" /></Button>\n                                <Button variant=\"ghost\" size=\"icon\" className=\"size-8\"><MoreHorizontal className=\"size-4\" /></Button>\n                            </div>\n                        </div>\n\n                        {/* Subject and Attachments */}\n                        <div className=\"p-4 border-b space-y-4\">\n                            <h2 className=\"text-xl font-bold\">{subject || 'Asunto del correo'}</h2>\n\n                            {attachmentName && (\n                            <div>\n                                <div className=\"flex items-center gap-2\">\n                                    <p className=\"text-sm font-medium\">1 archivo adjunto</p>\n                                    <span className=\"text-sm text-muted-foreground\">(~256 KB)</span>\n                                </div>\n                                <div className=\"mt-2 flex items-center gap-2 rounded-md border p-2 max-w-xs bg-muted/30\">\n                                    <File className=\"h-6 w-6 text-primary flex-shrink-0\" />\n                                    <div className=\"truncate\">\n                                        <p className=\"text-sm font-medium truncate\">{attachmentName}</p>\n                                    </div>\n                                </div>\n                            </div>\n                            )}\n                        </div>\n\n                        {/* Body */}\n                        <div className=\"bg-white w-full\">\n                            <iframe\n                                srcDoc={emailBody}\n                                title=\"Email Preview\"\n                                className={cn(\n                                    \"w-full h-[600px] border-0\",\n                                    previewMode === 'mobile' && 'rounded-[32px]'\n                                )}\n                                sandbox=\"allow-scripts\"\n                            />\n                            {certificatePreview && (\n                                <div className=\"p-4 bg-gray-100\">\n                                    <h3 className=\"text-lg font-semibold mb-2\">Vista Previa del Certificado</h3>\n                                    <img src={certificatePreview} alt=\"Vista previa del certificado\" className=\"max-w-full border rounded-md\" />\n                                </div>\n                            )}\n                        </div>\n\n                        {/* Footer actions */}\n                        <div className=\"p-2 border-t flex items-center gap-2 bg-muted/30\">\n                            <Button variant=\"outline\"><Reply className=\"mr-2\"/> Responder</Button>\n                            <Button variant=\"outline\"><Forward className=\"mr-2\"/> Reenviar</Button>\n                        </div>\n                    </div>\n                </div>\n            </CardContent>\n        </Card>\n\n          {lastRunStats && (\n            <Card>\n              <CardHeader><CardTitle>Resumen del Envío</CardTitle><CardDescription>Estadísticas del envío finalizado.</CardDescription></CardHeader>\n              <CardContent className=\"space-y-4 text-sm\">\n                <div className=\"flex items-center justify-between\"><span className=\"text-muted-foreground flex items-center gap-2\"><Users className=\"h-4 w-4\" /> Total Destinatarios</span><span className=\"font-bold\">{lastRunStats.totalRecipients}</span></div>\n                <div className=\"flex items-center justify-between\"><span className=\"text-muted-foreground flex items-center gap-2\"><CheckCircle className=\"h-4 w-4 text-green-500\" /> Enviados</span><span className=\"font-bold\">{lastRunStats.sentCount}</span></div>\n                <div className=\"flex items-center justify-between\"><span className=\"text-muted-foreground flex items-center gap-2\"><AlertTriangle className=\"h-4 w-4 text-destructive\" /> Fallidos</span><span className=\"font-bold\">{lastRunStats.failedCount}</span></div>\n                <div className=\"flex items-center justify-between\"><span className=\"text-muted-foreground flex items-center gap-2\"><Clock className=\"h-4 w-4\" /> Duración</span><span className=\"font-bold\">{lastRunStats.duration.toFixed(2)}s</span></div>\n                <div className=\"flex items-center justify-between\"><span className=\"text-muted-foreground flex items-center gap-2\"><TrendingUp className=\"h-4 w-4\" /> Velocidad Media</span><span className=\"font-bold\">{lastRunStats.duration > 0 ? (lastRunStats.sentCount / lastRunStats.duration).toFixed(2) : \"N/A\"} correos/s</span></div>\n              </CardContent>\n            </Card>\n          )}\n        </div>\n      </div>\n    </div>\n  );\n}\n"],"names":[],"mappings":"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","debugId":null}}]
}